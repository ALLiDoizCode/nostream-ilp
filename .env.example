# Nostream-ILP Environment Configuration
# Copy this file to .env and customize for your environment

# ============================================================================
# Dassie ILP Node Configuration (Story 1.2+)
# ============================================================================

# WebSocket URL for Dassie RPC endpoint
# Default: ws://localhost:5000/trpc (local development)
# Production: ws://dassie:5000/trpc (Docker Compose)
DASSIE_RPC_URL=ws://localhost:5000/trpc

# Feature flag: Are custom payment.* endpoints available in Dassie?
# Set to 'true' only after Epic 2 Dassie fork is complete
# Default: false
DASSIE_PAYMENT_ENDPOINTS_AVAILABLE=false

# ============================================================================
# Health Check Configuration (Story 1.7)
# ============================================================================

# HTTP endpoint for Dassie liveness check
# Used as fallback if WebSocket connection state is ambiguous
# Default: http://localhost:5000 (local development)
# Production: http://dassie:5000 (Docker Compose)
DASSIE_HTTP_URL=http://localhost:5000

# Degraded mode queue size limit
# Maximum number of payment verifications to queue during Dassie outage
# If exceeded, oldest events will be dropped
# Default: 10000
DEGRADED_MODE_MAX_QUEUE_SIZE=10000

# Health check interval (milliseconds)
# How often to poll Dassie HTTP health endpoint (WebSocket state is real-time)
# Note: Not currently used - health checks are on-demand via /healthz endpoint
# Default: 30000 (30 seconds)
# HEALTH_CHECK_INTERVAL_MS=30000

# ============================================================================
# Dashboard Authentication (Story 1.8)
# ============================================================================

# Dashboard username (optional, default: admin)
DASHBOARD_USERNAME=admin

# Dashboard password (REQUIRED for production)
# MUST be set to a strong password for dashboard access
# Leave empty only for local development (dashboard will be inaccessible)
DASHBOARD_PASSWORD=

# ============================================================================
# Nostream Relay Configuration
# ============================================================================

# See .nostr/settings.yaml for full relay configuration
# Environment variables can override YAML settings

# Relay name
# RELAY_NAME=nostream-ilp

# Relay description
# RELAY_DESCRIPTION=Nostr relay with ILP payment integration

# Public URL of this relay
# RELAY_PUBLIC_URL=wss://relay.example.com

# ============================================================================
# Database Configuration
# ============================================================================

# PostgreSQL connection
DB_HOST=localhost
DB_PORT=5432
DB_NAME=nostream
DB_USER=nostream
DB_PASSWORD=nostream

# Redis connection
REDIS_HOST=localhost
REDIS_PORT=6379
# REDIS_PASSWORD=

# ============================================================================
# Payment Configuration (Story 1.3+)
# ============================================================================

# Enable payment requirements for events
# PAYMENTS_ENABLED=false

# Currencies accepted for payment (comma-separated)
# ACCEPTED_CURRENCIES=BTC,BASE,AKT,XRP

# Minimum payment amounts (in smallest units: sats, wei, uakt, drops)
# MIN_PAYMENT_BTC_SATS=1000
# MIN_PAYMENT_BASE_WEI=100000000000000
# MIN_PAYMENT_AKT_UAKT=1000000
# MIN_PAYMENT_XRP_DROPS=1000000

# ============================================================================
# Pricing Configuration (Story 1.5)
# ============================================================================

# Default pricing for relay operations (in satoshis)
PRICING_STORE_EVENT=10           # Satoshis per event stored
PRICING_DELIVER_EVENT=1          # Satoshis per event delivered via REQ
PRICING_QUERY=5                  # Satoshis per REQ subscription

# Free Tier Configuration (Story 1.6)
# Number of free events per pubkey before payment required
# Set to 0 to disable free tier (all events require payment)
#
# Use cases:
#   - Trial period for new users
#   - Onboarding without requiring immediate payment setup
#   - Testing relay functionality before committing
#
# Example values:
#   100  = 100 free events (good for trial period, ~$1 value at 10 sats/event)
#   1000 = 1000 free events (generous trial, ~$10 value)
#   0    = no free tier (immediate payment required, recommended for production)
#
# Note: Whitelisted pubkeys have unlimited free events (see CLI tools)
# Note: Free tier is tracked per-pubkey in the database (persists across restarts)
PRICING_FREE_TIER_EVENTS=0

# Per-Kind Pricing Overrides (optional, comma-separated)
# Format: kind:amount (e.g., "1:10,30023:100,1063:500")
# Allows different pricing for specialized content types
# Examples:
#   - Kind 1 (short note): 10 sats
#   - Kind 30023 (long-form article): 100 sats
#   - Kind 1063 (file metadata): 500 sats
#   - Kind 71 (video): 1000 sats
PRICING_KIND_OVERRIDES=

# ============================================================================
# Logging Configuration
# ============================================================================

# Log level: trace, debug, info, warn, error, fatal
LOG_LEVEL=info

# Pretty print logs (development only)
LOG_PRETTY=true

# ============================================================================
# Development/Testing
# ============================================================================

# Node environment
NODE_ENV=development

# Enable debug output for specific modules (comma-separated)
# DEBUG=dassie-client,payment-processor

# Test mode (skip certain validations)
# TEST_MODE=false

# ============================================================================
# Cronos Deployment Configuration (Epic 3)
# ============================================================================

# Private key for deployer account (NEVER commit to version control)
# Generate with: npx hardhat account create
# Fund testnet wallet: https://cronos.org/faucet
# Format: 64 hex characters (without 0x prefix)
PRIVATE_KEY=

# CronoScan API key for contract verification
# Obtain from: https://cronoscan.com/myapikey (create free account)
# Required for: npx hardhat verify --network cronos-testnet/cronos-mainnet
CRONOSCAN_API_KEY=

# Deployed contract addresses (populated after deployment)
# Testnet (populated after Story 3.4)
CRONOS_TESTNET_MOCK_AKT_ADDRESS=
CRONOS_TESTNET_CHANNEL_ADDRESS=

# Mainnet (populated after Story 3.6)
# Mainnet AKT token address is hardcoded (bridged from Akash via IBC)
CRONOS_MAINNET_AKT_ADDRESS=0x39a65A74Dc5A778Ff93d1765Ea51F57BC49c81B3
CRONOS_MAINNET_CHANNEL_ADDRESS=0x9Ec2d217b14e67cAbF86F20F4E7462D6d7bc7684

# ============================================================================
# Base Mainnet Deployment (Epic 4)
# ============================================================================

# Base RPC URL (L2 Optimistic Rollup)
# Default: https://mainnet.base.org (public endpoint)
# Alternative: Use Alchemy/Infura for production with rate limits
BASE_RPC_URL=https://mainnet.base.org

# BaseScan API key for contract verification
# Obtain from: https://basescan.org/myapikey (create free account)
# Required for: npx hardhat verify --network base
BASESCAN_API_KEY=

# Multi-Token Payment Channel Factory (Story 4.2)
# Deployed contract address on Base Mainnet (Chain ID: 8453)
# Supports: Native ETH (address(0)) and USDC (0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913)
BASE_MAINNET_FACTORY_ADDRESS=0xf7e968d6f3bdFC504A434288Ea3f243e033e846F

# Supported tokens on Base (configured in src/config/base-tokens.yaml)
# ETH: Native L2 currency (18 decimals)
# USDC: Circle USD Coin (6 decimals) - 0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913
