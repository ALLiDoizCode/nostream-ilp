# Nostr-ILP Relay - Product Requirements Document (PRD)

## Table of Contents

- [Nostr-ILP Relay - Product Requirements Document (PRD)](#table-of-contents)
  - [Goals and Background Context](./goals-and-background-context.md)
    - [Goals](./goals-and-background-context.md#goals)
    - [Background Context](./goals-and-background-context.md#background-context)
    - [Existing Solutions We Build Upon](./goals-and-background-context.md#existing-solutions-we-build-upon)
    - [Change Log](./goals-and-background-context.md#change-log)
  - [Requirements](./requirements.md)
    - [Functional Requirements](./requirements.md#functional-requirements)
    - [Non-Functional Requirements](./requirements.md#non-functional-requirements)
  - [User Interface Design Goals](./user-interface-design-goals.md)
    - [Overall UX Vision](./user-interface-design-goals.md#overall-ux-vision)
    - [Key Interaction Paradigms](./user-interface-design-goals.md#key-interaction-paradigms)
    - [Core Screens and Views](./user-interface-design-goals.md#core-screens-and-views)
    - [Accessibility](./user-interface-design-goals.md#accessibility)
    - [Branding](./user-interface-design-goals.md#branding)
    - [Target Device and Platforms](./user-interface-design-goals.md#target-device-and-platforms)
  - [Technical Assumptions](./technical-assumptions.md)
    - [Repository Structure: Dual-Repo Approach](./technical-assumptions.md#repository-structure-dual-repo-approach)
    - [Service Architecture: Two-Process Deployment](./technical-assumptions.md#service-architecture-two-process-deployment)
    - [Payment Flow Architecture](./technical-assumptions.md#payment-flow-architecture)
    - [Inter-Process Communication: Dassie WebSocket RPC](./technical-assumptions.md#inter-process-communication-dassie-websocket-rpc)
    - [Akash Deployment Model](./technical-assumptions.md#akash-deployment-model)
    - [Database & Persistence](./technical-assumptions.md#database-persistence)
    - [CosmWasm Payment Channels (Akash/Cosmos)](./technical-assumptions.md#cosmwasm-payment-channels-akashcosmos)
    - [Testing Requirements](./technical-assumptions.md#testing-requirements)
    - [Technology Stack Summary](./technical-assumptions.md#technology-stack-summary)
  - [Success Metrics](./success-metrics.md)
    - [Primary Metrics (MVP)](./success-metrics.md#primary-metrics-mvp)
    - [Secondary Metrics (Production)](./success-metrics.md#secondary-metrics-production)
  - [MVP Validation Approach](./mvp-validation-approach.md)
    - [Phase 1: Local Development (Weeks 1-4)](./mvp-validation-approach.md#phase-1-local-development-weeks-1-4)
    - [Phase 2: Multi-Blockchain Settlement (Weeks 5-8)](./mvp-validation-approach.md#phase-2-multi-blockchain-settlement-weeks-5-8)
    - [Phase 3: Economic Monitoring (Weeks 9-10)](./mvp-validation-approach.md#phase-3-economic-monitoring-weeks-9-10)
    - [Phase 4: Akash Deployment (Weeks 11-12)](./mvp-validation-approach.md#phase-4-akash-deployment-weeks-11-12)
    - [Phase 5: Economic Validation (Weeks 13-16)](./mvp-validation-approach.md#phase-5-economic-validation-weeks-13-16)
  - [Out of Scope (Explicitly Excluded)](./out-of-scope-explicitly-excluded.md)
  - [Epic List](./epic-list.md)
    - [Epic 1: Nostream Fork & ILP Integration](./epic-list.md#epic-1-nostream-fork-ilp-integration)
    - [Epic 2: Dassie Multi-Blockchain Settlement Modules](./epic-list.md#epic-2-dassie-multi-blockchain-settlement-modules)
    - [Epic 3: CosmWasm Payment Channel Contract](./epic-list.md#epic-3-cosmwasm-payment-channel-contract)
    - [Epic 4: Economic Monitoring & Self-Sustainability](./epic-list.md#epic-4-economic-monitoring-self-sustainability)
    - [Epic 5: Akash Deployment & SDL](./epic-list.md#epic-5-akash-deployment-sdl)
    - [Epic 6: Arweave Permanent Storage Integration](./epic-list.md#epic-6-arweave-permanent-storage-integration)
    - [Epic 7: ILP Connector Revenue Optimization](./epic-list.md#epic-7-ilp-connector-revenue-optimization)
  - [Epic 1: Nostream Fork & ILP Integration](./epic-1-nostream-fork-ilp-integration.md)
    - [Story 1.1: Fork Nostream and Remove Centralized Payments](./epic-1-nostream-fork-ilp-integration.md#story-11-fork-nostream-and-remove-centralized-payments)
    - [Story 1.2: Create Dassie RPC Client for Nostream](./epic-1-nostream-fork-ilp-integration.md#story-12-create-dassie-rpc-client-for-nostream)
    - [Story 1.3: Define Payment Claim Format for Nostr Events](./epic-1-nostream-fork-ilp-integration.md#story-13-define-payment-claim-format-for-nostr-events)
    - [Story 1.4: Implement Payment Verification in EVENT Handler](./epic-1-nostream-fork-ilp-integration.md#story-14-implement-payment-verification-in-event-handler)
    - [Story 1.5: Add Pricing Configuration](./epic-1-nostream-fork-ilp-integration.md#story-15-add-pricing-configuration)
    - [Story 1.6: Implement Free Tier / Grace Period](./epic-1-nostream-fork-ilp-integration.md#story-16-implement-free-tier-grace-period)
    - [Story 1.7: Add Inter-Process Health Checks](./epic-1-nostream-fork-ilp-integration.md#story-17-add-inter-process-health-checks)
    - [Story 1.8: Create Unified Dashboard](./epic-1-nostream-fork-ilp-integration.md#story-18-create-unified-dashboard)
  - [Epic 2: Dassie Multi-Blockchain Settlement Modules](./epic-2-dassie-multi-blockchain-settlement-modules.md)
    - [Story 2.1: Set Up Dassie Development Environment](./epic-2-dassie-multi-blockchain-settlement-modules.md#story-21-set-up-dassie-development-environment)
    - [Story 2.2: Enable RPC Token Authentication in Dassie](./epic-2-dassie-multi-blockchain-settlement-modules.md#story-22-enable-rpc-token-authentication-in-dassie)
    - [Story 2.3: Add Payment Verification RPC Endpoint to Dassie](./epic-2-dassie-multi-blockchain-settlement-modules.md#story-23-add-payment-verification-rpc-endpoint-to-dassie)
    - [Story 2.4: Implement Bitcoin Lightning Settlement Module](./epic-2-dassie-multi-blockchain-settlement-modules.md#story-24-implement-bitcoin-lightning-settlement-module)
    - [Story 2.5: Create Base L2 Payment Channel Contract](./epic-2-dassie-multi-blockchain-settlement-modules.md#story-25-create-base-l2-payment-channel-contract)
    - [Story 2.6: Implement Base L2 Settlement Module in Dassie](./epic-2-dassie-multi-blockchain-settlement-modules.md#story-26-implement-base-l2-settlement-module-in-dassie)
    - [Story 2.7: Implement Cosmos/Akash Settlement Module in Dassie](./epic-2-dassie-multi-blockchain-settlement-modules.md#story-27-implement-cosmosakash-settlement-module-in-dassie)
    - [Story 2.8: Implement XRP Ledger Settlement Module in Dassie](./epic-2-dassie-multi-blockchain-settlement-modules.md#story-28-implement-xrp-ledger-settlement-module-in-dassie)
    - [Story 2.9: Add Additional RPC Endpoints for Economic Monitor](./epic-2-dassie-multi-blockchain-settlement-modules.md#story-29-add-additional-rpc-endpoints-for-economic-monitor)
  - [Epic 3: CosmWasm Payment Channel Contract](./epic-3-cosmwasm-payment-channel-contract.md)
    - [Story 3.1: Initialize CosmWasm Contract Project](./epic-3-cosmwasm-payment-channel-contract.md#story-31-initialize-cosmwasm-contract-project)
    - [Story 3.2: Implement Contract State and Messages](./epic-3-cosmwasm-payment-channel-contract.md#story-32-implement-contract-state-and-messages)
    - [Story 3.3: Implement OpenChannel Function](./epic-3-cosmwasm-payment-channel-contract.md#story-33-implement-openchannel-function)
    - [Story 3.4: Implement CloseChannel with Claim Verification](./epic-3-cosmwasm-payment-channel-contract.md#story-34-implement-closechannel-with-claim-verification)
    - [Story 3.5: Add Query Functions](./epic-3-cosmwasm-payment-channel-contract.md#story-35-add-query-functions)
    - [Story 3.6: Deploy Contract to Akash Testnet](./epic-3-cosmwasm-payment-channel-contract.md#story-36-deploy-contract-to-akash-testnet)
    - [Story 3.7: Create Contract Interaction Library for Dassie](./epic-3-cosmwasm-payment-channel-contract.md#story-37-create-contract-interaction-library-for-dassie)
  - [Epic 4: Economic Monitoring & Self-Sustainability](./epic-4-economic-monitoring-self-sustainability.md)
    - [Story 4.1: Create Economic Monitor Service in Nostream](./epic-4-economic-monitoring-self-sustainability.md#story-41-create-economic-monitor-service-in-nostream)
    - [Story 4.2: Implement Automatic Currency Conversion to AKT](./epic-4-economic-monitoring-self-sustainability.md#story-42-implement-automatic-currency-conversion-to-akt)
    - [Story 4.3: Integrate with Akash Provider Billing](./epic-4-economic-monitoring-self-sustainability.md#story-43-integrate-with-akash-provider-billing)
    - [Story 4.4: Implement Automatic Akash Escrow Deposit](./epic-4-economic-monitoring-self-sustainability.md#story-44-implement-automatic-akash-escrow-deposit)
    - [Story 4.5: Create Profitability Dashboard](./epic-4-economic-monitoring-self-sustainability.md#story-45-create-profitability-dashboard)
    - [Story 4.6: Add Economic Alerts](./epic-4-economic-monitoring-self-sustainability.md#story-46-add-economic-alerts)
    - [Story 4.7: Implement 30-Day Self-Sustainability Simulation](./epic-4-economic-monitoring-self-sustainability.md#story-47-implement-30-day-self-sustainability-simulation)
  - [Epic 5: Akash Deployment & SDL](./epic-5-akash-deployment-sdl.md)
    - [Story 5.1: Create Nostream Dockerfile](./epic-5-akash-deployment-sdl.md#story-51-create-nostream-dockerfile)
    - [Story 5.2: Create Dassie Dockerfile](./epic-5-akash-deployment-sdl.md#story-52-create-dassie-dockerfile)
    - [Story 5.3: Create Akash SDL with 2-Service Configuration](./epic-5-akash-deployment-sdl.md#story-53-create-akash-sdl-with-2-service-configuration)
    - [Story 5.4: Create Docker Compose for Local Testing](./epic-5-akash-deployment-sdl.md#story-54-create-docker-compose-for-local-testing)
    - [Story 5.5: Deploy to Akash Testnet](./epic-5-akash-deployment-sdl.md#story-55-deploy-to-akash-testnet)
    - [Story 5.6: Deploy to Akash Mainnet](./epic-5-akash-deployment-sdl.md#story-56-deploy-to-akash-mainnet)
    - [Story 5.7: Implement Akash Cost Monitoring](./epic-5-akash-deployment-sdl.md#story-57-implement-akash-cost-monitoring)
    - [Story 5.8: Create Deployment Automation Script](./epic-5-akash-deployment-sdl.md#story-58-create-deployment-automation-script)
  - [Epic 6: Arweave Permanent Storage Integration](./epic-6-arweave-permanent-storage-integration.md)
    - [Story 6.1: Set Up Arweave Wallet Management](./epic-6-arweave-permanent-storage-integration.md#story-61-set-up-arweave-wallet-management)
    - [Story 6.2: Implement Bundled Pricing Calculator](./epic-6-arweave-permanent-storage-integration.md#story-62-implement-bundled-pricing-calculator)
    - [Story 6.3: Add Arweave Reference Tags to Nostr Events](./epic-6-arweave-permanent-storage-integration.md#story-63-add-arweave-reference-tags-to-nostr-events)
    - [Story 6.4: Implement Upload Endpoint with Payment Verification](./epic-6-arweave-permanent-storage-integration.md#story-64-implement-upload-endpoint-with-payment-verification)
    - [Story 6.5: Implement Automatic Daily Backup to Arweave](./epic-6-arweave-permanent-storage-integration.md#story-65-implement-automatic-daily-backup-to-arweave)
    - [Story 6.6: Implement Hot/Cold Storage Tier Management](./epic-6-arweave-permanent-storage-integration.md#story-66-implement-hotcold-storage-tier-management)
    - [Story 6.7: Add Arweave Configuration and Monitoring](./epic-6-arweave-permanent-storage-integration.md#story-67-add-arweave-configuration-and-monitoring)
    - [Story 6.8: Implement Backup Restoration Process](./epic-6-arweave-permanent-storage-integration.md#story-68-implement-backup-restoration-process)
  - [Epic 7: ILP Connector Revenue Optimization](./epic-7-ilp-connector-revenue-optimization.md)
    - [Story 7.1: Configure Dassie as Public ILP Connector](./epic-7-ilp-connector-revenue-optimization.md#story-71-configure-dassie-as-public-ilp-connector)
    - [Story 7.2: Implement Routing Fee Configuration](./epic-7-ilp-connector-revenue-optimization.md#story-72-implement-routing-fee-configuration)
    - [Story 7.3: Establish Peering with Liquidity Providers](./epic-7-ilp-connector-revenue-optimization.md#story-73-establish-peering-with-liquidity-providers)
    - [Story 7.4: Verify Routing Statistics RPC](./epic-7-ilp-connector-revenue-optimization.md#story-74-verify-routing-statistics-rpc)
    - [Story 7.5: Add Routing Revenue to Dashboard](./epic-7-ilp-connector-revenue-optimization.md#story-75-add-routing-revenue-to-dashboard)
    - [Story 7.6: Optimize Liquidity Distribution](./epic-7-ilp-connector-revenue-optimization.md#story-76-optimize-liquidity-distribution)
  - [Success Metrics](./success-metrics.md)
    - [Primary Metrics (MVP - 12-16 Weeks)](./success-metrics.md#primary-metrics-mvp-12-16-weeks)
    - [Secondary Metrics (Production - 6 Months)](./success-metrics.md#secondary-metrics-production-6-months)
  - [Timeline Estimate](./timeline-estimate.md)
  - [Risk Assessment & Mitigation](./risk-assessment-mitigation.md)
    - [Top Risks](./risk-assessment-mitigation.md#top-risks)
  - [Success Criteria (MVP Complete When...)](./success-criteria-mvp-complete-when.md)
  - [Next Steps](./next-steps.md)
    - [For Architect:](./next-steps.md#for-architect)
    - [For Implementation:](./next-steps.md#for-implementation)
    - [For Business/Marketing:](./next-steps.md#for-businessmarketing)
